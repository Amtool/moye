/*! 2014 Baidu Inc. All Rights Reserved */
define("Rating",["require","./lib","./Control"],function(require){var t=require("./lib"),e=require("./Control"),i={drain:function(){var e=this.options,i=e.prefix,n=this.query(i+"-star-on");t.each(n,function(e){t.removeClass(e,i+"-star-on")})},fill:function(e){e=parseInt(e||0,10);var i=this.options,n=i.prefix,s=this.stars.slice(0,e);return t.each(s,function(e){t.addClass(e,n+"-star-on")}),s},resetRating:function(){var e=this.options,i=e.value,n=e.prefix,s=this.stars.slice(0,i);return t.each(s,function(e){t.addClass(e,n+"-star-on")}),s},onClick:function(e){var n=this.options,s=n.prefix,a=t.getTarget(e),r=n.value;if(!e||this.disabled)return!1;if(t.hasClass(a,s+"-star")){var o=parseInt(a.getAttribute("data-value"),10);if(o===r)return!1;n.value=o,i.drain.call(this),i.resetRating.call(this),this.fire("rated",{value:n.value})}},onMouseOver:function(e){var n=this.options,s=n.prefix,a=t.getTarget(e);if(!e||this.disabled)return!1;if(t.hasClass(a,s+"-star"))i.drain.call(this),i.fill.call(this,a.getAttribute("data-value"))},onMouseOut:function(e){var n=this.options,s=n.prefix,a=t.getTarget(e);if(!e||this.disabled)return!1;if(t.hasClass(a,s+"-star"))i.drain.call(this),i.resetRating.call(this)}},n=e.extend({options:{disabled:!1,main:"",prefix:"ecl-ui-rating",max:5,value:0,skin:0},type:"Rating",init:function(e){this.main=t.g(e.main),this._disabled=e.disabled,this.bindEvents(i)},render:function(){var e=this.options;if(!this.rendered){this.rendered=!0;var n=[],s=e.prefix;n.push('<ul class="'+s+'-stars">');for(var a=0;a<e.max;a++)n.push("<li ",'class="'+s+'-star" ','data-value="'+(a+1)+'"',">",e.skin?"":"â˜†","</li>");n.push("</ul>"),this.main.innerHTML=n.join(""),this.stars=this.query(s+"-star");var r=this._bound;t.each(this.stars,function(e){t.on(e,"mouseover",r.onMouseOver),t.on(e,"mouseout",r.onMouseOut),t.on(e,"click",r.onClick)})}return i.resetRating.call(this),this._disabled&&this.disable(),this},enable:function(){t.removeClass(this.main,this.options.prefix+"-disabled"),this.parent("enable")},disable:function(){t.addClass(this.main,this.options.prefix+"-disabled"),this.parent("disable")},dispose:function(){var e=this._bound;t.each(this.stars,function(i){t.un(i,"click",e.onClick),t.un(i,"mouseover",e.onMouseOver),t.un(i,"mouseout",e.onMouseOut)}),delete this.stars,this.parent("dispose")}});return n});