/*! 2014 Baidu Inc. All Rights Reserved */
define("City",["require","./lib","./Control","./Popup"],function(require){var t=require("./lib"),e=require("./Control"),i=require("./Popup"),a={build:function(){var e=this.options,i=e.prefix,a=this.index,n=' class="'+i+'-active"',s=[],r=[];s.push('<ul class="'+i+'-labels c-clearfix">'),r.push('<ul class="'+i+'-panels">');var h=",",o=e.hideCities;if(o)o=h+o.replace(/\s+/g,"")+h;var l=function(e){var i=[];return t.each(e.split(h),function(t){if(!o||!~o.indexOf(h+t+h))i.push('<a href="#" title="'+t+'">'+t+"</a>")}),i.join("")};return t.each(this.tabs,function(t,e,i){t=t.split("|"),i='<li data-idx="'+e+'"'+(e===a?n:""),s.push(i+">"+t[0]+"</li>"),r.push(i+">"+l(t[1])+"</li>")}),s.push("</ul>"),r.push("</ul>"),s.join("")+r.join("")},onClick:function(e){var i=e.event;if(i){var n=t.getTarget(i),s=n.tagName,r=this.target,h=n.getAttribute("data-idx");switch(s){case"A":if(t.preventDefault(i),n.className)this.hide();else a.pick.call(this,n);break;case"LI":if(h)this.change(h);break;default:if(r)r.select()}this.fire("click",e)}},onBeforeShow:function(t){if(this.fire("beforeShow",t),!this.labels){var e=this.popup;e.content=a.build.call(this),e.render();var i=this.main,n=i.getElementsByTagName("ul");this.labels=n[0].getElementsByTagName("li"),this.panels=n[1].getElementsByTagName("li")}},pick:function(t){var e=t.innerHTML,i=this.target;if(i)if(i.type)i.value=e,i.focus();else i.innerHTML=e;this.fire("pick",{value:e}),this.hide()}},n=e.extend({type:"City",options:{disabled:!1,main:"",target:"",prefix:"ecl-hotel-ui-city",index:0,activeClass:"active",autoFill:!0,hideCities:null},binds:"onClick,onBeforeShow",init:function(t){this.disabled=t.disabled,this.index=t.index;var e=this.tabs=[];if(t.autoFill)e.push("热门|上海,北京,广州,昆明,西安,成都,深圳,厦门,乌鲁木齐,南京,重庆,杭州,大连,长沙,海口,哈尔滨,青岛,沈阳,三亚,济南,武汉,郑州,贵阳,南宁,福州,天津,长春,石家庄,太原,兰州"),e.push("A-G|安庆,阿勒泰,安康,鞍山,安顺,安阳,阿克苏,包头,蚌埠,北海,北京,百色,保山,博乐,长治,长春,长海,常州,昌都,朝阳,潮州,常德,长白山,成都,重庆,长沙,赤峰,大同,大连,达县,大足,东营,大庆,丹东,大理,敦煌,鄂尔多斯,恩施,二连浩特,佛山,福州,阜阳,富蕴,贵阳,桂林,广州,广元,赣州,格尔木,广汉,固原"),e.push("H-L|呼和浩特,哈密,黑河,海拉尔,哈尔滨,海口,衡阳,黄山,杭州,邯郸,合肥,黄龙,汉中,和田,惠州,吉安,吉林,酒泉,鸡西,晋江,锦州,景德镇,嘉峪关,井冈山,济宁,九江,佳木斯,济南,喀什,昆明,康定,克拉玛依,库尔勒,喀纳斯,库车,兰州,洛阳,丽江,梁平,荔波,庐山,林芝,柳州,泸州,连云港,黎平,连城,拉萨,临沧,临沂"),e.push("M-T|牡丹江,芒市,满洲里,绵阳,梅县,漠河,南京,南充,南宁,南阳,南通,那拉提,南昌,宁波,攀枝花,衢州,秦皇岛,庆阳,且末,齐齐哈尔,青岛,汕头,深圳,石家庄,三亚,沈阳,上海,思茅,鄯善,韶关,沙市,苏州,唐山,铜仁,通化,塔城,腾冲,台州,天水,天津,通辽,太原,吐鲁番"),e.push("W-Z|威海,武汉,梧州,文山,无锡,潍坊,武夷山,乌兰浩特,温州,乌鲁木齐,芜湖,万州,乌海,兴义,西昌,厦门,香格里拉,西安,襄阳,西宁,锡林浩特,西双版纳,徐州,兴城,兴宁,邢台,义乌,永州,榆林,延安,运城,烟台,银川,宜昌,宜宾,盐城,延吉,玉树,伊宁,伊春,珠海,昭通,张家界,舟山,郑州,中卫,芷江,湛江,中甸,遵义");this.bindEvents(a)},fill:function(e){var i=this.tabs;if(t.isString(e))i.push(e);else this.tabs=e;return this},render:function(){var e=this.options;if(!this.rendered){this.rendered=!0;var a=this.popup=new i(this.srcOptions),n=this._bound;if(a.on("click",t.bind(n.onClick,this)),a.on("beforeShow",t.bind(n.onBeforeShow,this)),this.main=a.main,e.target)this.setTarget(t.g(e.target))}return this},setTarget:function(t){if(!t||1!==t.nodeType)throw new Error("target 为 null 或非 Element 节点");if(this.target=t,this.popup)this.popup.target=t},change:function(e){var i=this.options,a=this.labels,n=this.panels,s=this.index,r=i.prefix+"-"+i.activeClass;if(e|=0,e!==s)t.removeClass(a[s],r),t.removeClass(n[s],r),s=this.index=e,t.addClass(a[s],r),t.addClass(n[s],r)},show:function(t){this.popup.show(),this.fire("show",{target:t})},hide:function(){this.popup.hide(),this.fire("hide")}});return n});