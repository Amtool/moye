/*! 2015 Baidu Inc. All Rights Reserved */
define("moye/ui/plugin/ValidateTip",["require","jquery","./Plugin","../lib","../Tip"],function(require){var t=require("jquery"),e=require("./Plugin"),i=require("../lib"),n=require("../Tip"),s=e.extend({$class:"ValidateTip",options:{listen:["validating","aftervalidate","change"],message:{skin:"validate-tip",arrow:"rc",mode:"static",offset:{x:5}},icon:{content:"校验中...",skin:"validate-tip-icon",mode:"static",arrow:"rc",offset:{x:5}}},activate:function(e){var s=e.main,r=this.message;if(r)this.message=new n(i.extend({target:s},i.clone(r))).render();var a=this.icon;if(a)this.icon=new n(i.extend({target:s},i.clone(a))).render();var o=t.proxy(this.onValidityChange,this);i.each(this.listen,function(t){e.on(t,o)}),this.target=e},show:function(t){var e=this.message;if(t.isValid())e.hide();else e.set("content",this.getMessage(t)),e.show()},hide:function(){this.message.hide()},showLoading:function(){if(this.icon)this.icon.show()},hideLoading:function(){if(this.icon)this.icon.hide()},getMessage:function(t){var e=t.getCustomMessage();if(e)return e;for(var i=t.getStates(),n=i.length-1;n>=0;n--)if(!i[n].getState())return i[n].getMessage()},onValidityChange:function(t){var e=t.type;switch(e){case"validating":this.showLoading(),this.hide();break;case"aftervalidate":this.show(t.validity),this.hideLoading();break;case"change":this.hide()}},dispose:function(){this.message.destroy(),this.icon&&this.icon.destroy(),this.target=this.icon=this.message=null,this.$parent()}});return s});