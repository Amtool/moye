/*! 2015 Baidu Inc. All Rights Reserved */
define("moye/ui/LazyImg",["require","jquery","./lib","./Lazy"],function(require){var t=require("jquery"),e=require("./lib"),i=require("./Lazy"),n={load:function(e,n){var s=this.options.src,r=this.options.offset;if(this.imgs=t.grep(this.imgs,function(i){i=t(i);var a=i.parent(),h=i.attr(s);if(!a.height()||!h)return!1;var o=i.offset();o.right=o.left+i.width(),o.bottom=o.top+i.height();var u=o.left-r.x>=e.x+n.x,l=o.top-r.y>=e.y+n.y,c=o.right+r.x<=e.x,p=o.bottom+r.y<=e.y;if(!(u||l||c||p))return i.attr("src",h),i.removeAttr(s),!1;else return!0}),!this.imgs.length)i.remove(this.main)}},s=e.newClass({type:"LazyImg",options:{main:"",src:"_src",imgs:null,offset:{y:32}},initialize:function(s){this.setOptions(s);var r=this.main=e.g(s.main)||t("."+s.main)[0];this.imgs=s.imgs||t("img",r).toArray(),i.add(r,t.proxy(n.load,this),s.offset)}}).implement(e.configurable);return s.load=function(i,n){if(e.isObject(i))n=i,i=null;n=n||{},i=i||"lazy-img",t("."+i).each(function(e,i){new s(t.extend(n,{main:i}))})},s});