/*! 2015 Baidu Inc. All Rights Reserved */
define("moye/ui/Tag",["require","jquery","./Control","./painter"],function(require){var t=require("jquery"),i=require("./Control"),e=i.extend({type:"Tag",options:{adapter:{toName:function(t){return t},toValue:function(t){return t}},value:[]},init:function(i){this.$parent(i),this.value=this.value&&this.value.length?this.value:t(this.main).data("value")||[]},initEvents:function(){this.delegate(this.main,"click",this._onMainClick)},repaint:require("./painter").createRepaint(i.prototype.repaint,{name:["value"],paint:function(t,i){var e=this.helper;if(this.value=i,!e.isInStage("INITED")||!i){for(var s=[],n=e.getPartClassName("item"),a=0,r=i.length;r>a;a++){var o=i[a],h=this.adapter.toName(o),l=this.adapter.toValue(o);s[a]='<a href="#" class="'+n+'" data-index="'+a+'" data-value="'+l+'" title="'+h+'">'+e.getPartHTML("content","span",h)+e.getPartHTML("remove","i","x")+"</a>"}this.main.innerHTML=s.join("")}}}),_onMainClick:function(i){var e=t(i.target),s=this.helper.getPrimaryClassName("remove");if(i.preventDefault(),e.hasClass(s)){var n=this.value,a=e.parent(),r=+a.data("index");this.setValue(n.slice(0,r).concat(n.slice(r+1))),this.fire("change")}},getValue:function(){return this.value},setValue:function(t){return this.value=null,this.set("value",t),this},add:function(t){return this.setValue(this.value.concat(t)),this},remove:function(t){for(var i=this.value,e=this.value.length-1;e>=0;e--){var s=i[e];if(this.adapter.toValue(s)===t){this.setValue(i.slice(0,e).concat(i.slice(e+1)));break}}return this},getCount:function(){return this.value.length}});return e});