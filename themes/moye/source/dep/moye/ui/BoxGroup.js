/*! 2015 Baidu Inc. All Rights Reserved */
define("moye/ui/BoxGroup",["require","jquery","./Control","./painter"],function(require){var e=require("jquery"),t=require("./Control"),i=require("./painter"),a={"default":{normal:"",expanded:""},"radio-point":{normal:"&#xe60b;",expanded:"&#xe60a;"},"checkbox-tick":{normal:"&#xe60c;",expanded:"&#xe60d;"}},n=t.extend({type:"BoxGroup",options:{main:"",boxType:"checkbox",activeClass:"checked",styleClass:"default",datasource:[],value:[]},init:function(e){this.$parent(e)},initEvents:function(){this.delegate(this.main,"click","label",this.onClick)},repaint:i.createRepaint(t.prototype.repaint,{name:"datasource",paint:function(t,i){var a=e(this.main);if(!this.helper.isInStage("INITED")||!a.data("dom-inited")){i=this.datasource=i||[];for(var n=[],s=0,r=i.length;r>s;s++){var o=i[s],l=e.inArray(o.value,this.value)>-1;n[s]=this.getItemHTML(l,o)}return a.html(n.join("")),this}}},{name:"value",paint:function(t,i){var a=e(this.main);if(!this.helper.isInStage("INITED")||!a.data("dom-inited")){if(i=this.value=i||[],"radio"===this.boxType.toLowerCase())i.length=1;e("label",a).each(function(){var t=e(this),a=t.find("input"),n=+a.prop("value"),s=e.inArray(n,i)>-1,r=s?"addClass":"removeClass";t[r](this.activeClass),a.prop("checked",s)})}}}),onClick:function(t){var i=this,a=e(t.target),n=a,s=a.prop("tagName"),r="radio"===i.boxType.toLowerCase();if("INPUT"===s||"I"===s)t.preventDefault()||(t.returnValue=!1),a=a.parent();else t.preventDefault()||(t.returnValue=!1),n=a.find("input");if(!r||!n.prop("checked")){var o=i.activeClass,l=e(i.main).find("."+o);if(r)l&&l.removeClass(o).find("input").prop("checked",!1);var u=!a.hasClass(o);a.toggleClass(o).find("input").prop("checked",u),this.fire("change",{target:this})}},getItemHTML:function(e,t){var i=e?" "+this.activeClass:"",n=a[this.styleClass];return'<label class="'+this.styleClass+i+'"><i class="icon icon-un">'+n.normal+'</i><i class="icon icon-on">'+n.expanded+'</i><input type="'+this.boxType+'" value="'+t.value+'">'+t.name+"</label>"},getValue:function(){var t=[],i=e(this.main);return e("."+this.activeClass+" input",i).each(function(){t.push(e(this).prop("value"))}),t},setValue:function(e){return this.value=null,this.set("value",e)},dispose:function(){this.undelegate(this.main,"click","label",this.onClick),t.prototype.dispose.apply(this,arguments)}});return n});