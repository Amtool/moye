/*! 2015 Baidu Inc. All Rights Reserved */
define("moye/BoxGroup",["require","jquery","./Control","./painter","./lib"],function(require){var e=require("jquery"),i=require("./Control"),t=require("./painter"),n=require("./lib"),a={checkbox:{checked:'<i class="moye-icon moye-icon-checked">&#xe60d;</i>',unchecked:'<i class="moye-icon moye-icon-unchecked">&#xe60c;</i>'},radio:{checked:'<i class="moye-icon moye-icon-checked">&#xe60a;</i>',unchecked:'<i class="moye-icon moye-icon-unchecked">&#xe60b;</i>'}},s=i.extend({type:"BoxGroup",options:{main:"",boxType:"checkbox",activeClass:"ui-boxgroup-item-checked",itemSelector:"[data-role=boxgroup-item]",icons:{},datasource:[],value:[]},init:function(e){this.$parent(e),this.icons=this.getIcons(this.icons),this.onClick=n.throttle.call(this,this.onClick,50),n.each(this.value,function(e,i){this.value[i]=e+""},this)},getIcons:function(e){return e===!1?null:n.extend({},a[this.boxType],e)},initEvents:function(){this.delegate(this.main,"click",this.itemSelector,this.onClick)},initStructure:function(){e(this.main).addClass(this.helper.getPrimaryClassName(this.boxType))},repaint:t.createRepaint(i.prototype.repaint,{name:"datasource",paint:function(i,t){var n=e(this.main);if(!this.helper.isInStage("INITED")||!n.data("dom-inited")){t=this.datasource=t||[];for(var a=[],s=0,o=t.length;o>s;s++){var c=t[s];c.value+="";var r=e.inArray(c.value,this.value)>-1;a[s]=this.getItemHTML(r,c)}return n.html(a.join("")),this}}},{name:"value",paint:function(i,t){var a=e(this.main);if(!this.helper.isInStage("INITED")||!a.data("dom-inited")){if(n.each(t,function(e,i){t[i]=e+""}),t=this.value=t||[],"radio"===this.boxType.toLowerCase())t.length=1;var s=this;e(this.itemSelector,a).each(function(){var i=e(this),n=i.find("input"),a=n.prop("value"),o=e.inArray(a,t)>-1;i[o?"addClass":"removeClass"](s.activeClass),n.prop("checked",o)})}}}),onClick:function(i){var t=e(i.currentTarget),n=t.find("input"),a="radio"===this.boxType.toLowerCase();if(!a||!n.prop("checked")){var s=this.activeClass,o=e(this.main).find("."+s);if(a&&o)o.removeClass(s).find("input").prop("checked",!1);t.toggleClass(s),n.prop("checked",!t.hasClass(s)),this.fire("change")}},getItemHTML:function(e,i){var t=this.helper.getPartClasses("item");if(e)t.push(this.activeClass);var n=this.icons||{},a=n.checked||"",s=n.unchecked||"";return'<label class="'+t.join(" ")+'" data-role="boxgroup-item">'+a+s+'<input type="'+this.boxType+'" value="'+i.value+'">'+i.name+"</label>"},getValue:function(){var i=[];return e("."+this.activeClass+" input",this.main).map(function(){i.push(e(this).val())}),i},setValue:function(e){return this.set("value",e),this},dispose:function(){this.undelegate(this.main,"click",this.itemSelector,this.onClick),this.$parent()}});return s});